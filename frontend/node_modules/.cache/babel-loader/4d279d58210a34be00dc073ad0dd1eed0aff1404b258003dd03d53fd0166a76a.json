{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useLocation } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getRelatedIdsByEntityId } from \"../../../../shared/utils\";\nimport React, { useEffect, useMemo } from \"react\";\nimport { setProgress } from \"../../../../features/statistics/linearGraph/model/slice\";\nimport { createPublication } from \"../../../../shared/api/communityApi\";\nimport { selectGroupById } from \"../../../../entities/group\";\nimport { selectModulesByGroupId } from \"../../../../entities/module\";\nimport { getProgressByModule } from \"../../../../shared/api\";\nexport function useGroupSectionLogic() {\n  _s();\n  const user = useSelector(state => state.user);\n  const groupId = +useLocation().pathname.split(\"/\")[2];\n  const group = useSelector(selectGroupById(groupId))[0];\n  const groupModules = useSelector(state => state.groupModule.groupModules);\n  const moduleIds = getRelatedIdsByEntityId(groupId, groupModules, 'groupId', 'moduleId');\n  const modules = useSelector(selectModulesByGroupId(moduleIds));\n  const [isOpenGroupManager, setIsOpenGroupManager] = React.useState(false);\n\n  // @ts-ignore\n  const isOwner = user.user.id === group.userId;\n  const groupInfo = useMemo(() => {\n    if (group) {\n      return {\n        id: group.id,\n        name: group.name,\n        img: group.img,\n        description: group.description,\n        selectedModuleIds: moduleIds\n      };\n    }\n  }, [group, moduleIds]);\n\n  ////переделать\n  const dispatch = useDispatch();\n  useEffect(() => {\n    getProgressByModule(moduleIds).then(data => {\n      dispatch(setProgress(data));\n    }).catch(e => {\n      console.log(e);\n    });\n\n    // getProgressByGroup(groupId).then((data) => {\n    //     dispatch(setProgress(data))\n    // })\n    // getTrainingByGroup(groupId).then(data => {\n    //     dispatch(setSessions(data))\n    // })\n  }, []);\n\n  ////переделать\n\n  function publish() {\n    createPublication(groupId);\n  }\n  return {\n    groupId,\n    group,\n    groupModules,\n    moduleIds,\n    modules,\n    groupInfo,\n    isOpenGroupManager,\n    setIsOpenGroupManager,\n    publish,\n    isOwner\n  };\n}\n_s(useGroupSectionLogic, \"0lRq1Usy+qqX5OCdWNGijd5RD24=\", false, function () {\n  return [useSelector, useLocation, useSelector, useSelector, useSelector, useDispatch];\n});","map":{"version":3,"names":["useLocation","useDispatch","useSelector","getRelatedIdsByEntityId","React","useEffect","useMemo","setProgress","createPublication","selectGroupById","selectModulesByGroupId","getProgressByModule","useGroupSectionLogic","_s","user","state","groupId","pathname","split","group","groupModules","groupModule","moduleIds","modules","isOpenGroupManager","setIsOpenGroupManager","useState","isOwner","id","userId","groupInfo","name","img","description","selectedModuleIds","dispatch","then","data","catch","e","console","log","publish"],"sources":["D:/base/GitHub/MemoryCard/frontend/src/widgets/gruopSections/model/hooks/useGroupSectionLogic.ts"],"sourcesContent":["import {useLocation} from \"react-router-dom\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {RootState} from \"../../../../app/store\";\r\nimport {getRelatedIdsByEntityId} from \"../../../../shared/utils\";\r\nimport React, {use, useEffect, useMemo} from \"react\";\r\nimport {setProgress} from \"../../../../features/statistics/linearGraph/model/slice\";\r\nimport {createPublication} from \"../../../../shared/api/communityApi\";\r\nimport {selectGroupById} from \"../../../../entities/group\";\r\nimport {selectModulesByGroupId} from \"../../../../entities/module\";\r\nimport {getProgressByModule} from \"../../../../shared/api\";\r\n\r\nexport function useGroupSectionLogic() {\r\n    const user = useSelector((state: RootState) => state.user);\r\n    const groupId = +useLocation().pathname.split(\"/\")[2];\r\n    const group = useSelector(selectGroupById(groupId))[0];\r\n\r\n    const groupModules = useSelector((state: RootState) => state.groupModule.groupModules);\r\n    const moduleIds = getRelatedIdsByEntityId(groupId, groupModules, 'groupId', 'moduleId')\r\n    const modules = useSelector(selectModulesByGroupId(moduleIds))\r\n\r\n    const [isOpenGroupManager, setIsOpenGroupManager] = React.useState(false);\r\n\r\n    // @ts-ignore\r\n    const isOwner = user.user.id === group.userId\r\n\r\n    const groupInfo = useMemo(() => {\r\n        if (group) {\r\n            return {\r\n                id: group.id,\r\n                name: group.name,\r\n                img: group.img,\r\n                description: group.description,\r\n                selectedModuleIds: moduleIds,\r\n            }\r\n        }\r\n    }, [group, moduleIds]);\r\n\r\n    ////переделать\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        getProgressByModule(moduleIds).then(data => {\r\n            dispatch(setProgress(data))\r\n        }).catch(e => {\r\n            console.log(e)\r\n        })\r\n\r\n        // getProgressByGroup(groupId).then((data) => {\r\n        //     dispatch(setProgress(data))\r\n        // })\r\n        // getTrainingByGroup(groupId).then(data => {\r\n        //     dispatch(setSessions(data))\r\n        // })\r\n    }, [])\r\n\r\n    ////переделать\r\n\r\n    function publish() {\r\n        createPublication(groupId)\r\n    }\r\n\r\n    return {\r\n        groupId,\r\n        group,\r\n        groupModules,\r\n        moduleIds,\r\n        modules,\r\n        groupInfo,\r\n        isOpenGroupManager,\r\n        setIsOpenGroupManager,\r\n        publish,\r\n        isOwner,\r\n    }\r\n}"],"mappings":";AAAA,SAAQA,WAAW,QAAO,kBAAkB;AAC5C,SAAQC,WAAW,EAAEC,WAAW,QAAO,aAAa;AAEpD,SAAQC,uBAAuB,QAAO,0BAA0B;AAChE,OAAOC,KAAK,IAAQC,SAAS,EAAEC,OAAO,QAAO,OAAO;AACpD,SAAQC,WAAW,QAAO,yDAAyD;AACnF,SAAQC,iBAAiB,QAAO,qCAAqC;AACrE,SAAQC,eAAe,QAAO,4BAA4B;AAC1D,SAAQC,sBAAsB,QAAO,6BAA6B;AAClE,SAAQC,mBAAmB,QAAO,wBAAwB;AAE1D,OAAO,SAASC,oBAAoBA,CAAA,EAAG;EAAAC,EAAA;EACnC,MAAMC,IAAI,GAAGZ,WAAW,CAAEa,KAAgB,IAAKA,KAAK,CAACD,IAAI,CAAC;EAC1D,MAAME,OAAO,GAAG,CAAChB,WAAW,CAAC,CAAC,CAACiB,QAAQ,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EACrD,MAAMC,KAAK,GAAGjB,WAAW,CAACO,eAAe,CAACO,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;EAEtD,MAAMI,YAAY,GAAGlB,WAAW,CAAEa,KAAgB,IAAKA,KAAK,CAACM,WAAW,CAACD,YAAY,CAAC;EACtF,MAAME,SAAS,GAAGnB,uBAAuB,CAACa,OAAO,EAAEI,YAAY,EAAE,SAAS,EAAE,UAAU,CAAC;EACvF,MAAMG,OAAO,GAAGrB,WAAW,CAACQ,sBAAsB,CAACY,SAAS,CAAC,CAAC;EAE9D,MAAM,CAACE,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGrB,KAAK,CAACsB,QAAQ,CAAC,KAAK,CAAC;;EAEzE;EACA,MAAMC,OAAO,GAAGb,IAAI,CAACA,IAAI,CAACc,EAAE,KAAKT,KAAK,CAACU,MAAM;EAE7C,MAAMC,SAAS,GAAGxB,OAAO,CAAC,MAAM;IAC5B,IAAIa,KAAK,EAAE;MACP,OAAO;QACHS,EAAE,EAAET,KAAK,CAACS,EAAE;QACZG,IAAI,EAAEZ,KAAK,CAACY,IAAI;QAChBC,GAAG,EAAEb,KAAK,CAACa,GAAG;QACdC,WAAW,EAAEd,KAAK,CAACc,WAAW;QAC9BC,iBAAiB,EAAEZ;MACvB,CAAC;IACL;EACJ,CAAC,EAAE,CAACH,KAAK,EAAEG,SAAS,CAAC,CAAC;;EAEtB;EACA,MAAMa,QAAQ,GAAGlC,WAAW,CAAC,CAAC;EAE9BI,SAAS,CAAC,MAAM;IACZM,mBAAmB,CAACW,SAAS,CAAC,CAACc,IAAI,CAACC,IAAI,IAAI;MACxCF,QAAQ,CAAC5B,WAAW,CAAC8B,IAAI,CAAC,CAAC;IAC/B,CAAC,CAAC,CAACC,KAAK,CAACC,CAAC,IAAI;MACVC,OAAO,CAACC,GAAG,CAACF,CAAC,CAAC;IAClB,CAAC,CAAC;;IAEF;IACA;IACA;IACA;IACA;IACA;EACJ,CAAC,EAAE,EAAE,CAAC;;EAEN;;EAEA,SAASG,OAAOA,CAAA,EAAG;IACflC,iBAAiB,CAACQ,OAAO,CAAC;EAC9B;EAEA,OAAO;IACHA,OAAO;IACPG,KAAK;IACLC,YAAY;IACZE,SAAS;IACTC,OAAO;IACPO,SAAS;IACTN,kBAAkB;IAClBC,qBAAqB;IACrBiB,OAAO;IACPf;EACJ,CAAC;AACL;AAACd,EAAA,CA9DeD,oBAAoB;EAAA,QACnBV,WAAW,EACPF,WAAW,EACdE,WAAW,EAEJA,WAAW,EAEhBA,WAAW,EAoBVD,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}