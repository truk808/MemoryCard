{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect } from 'react';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { saveCard } from \"./services\";\nimport { selectAllTags } from \"../../../entities/tag\";\nimport { useItemForm } from \"../../../shared/hooks\";\nconst initCardForm = {\n  term: '',\n  meaning: '',\n  example_sentence: '',\n  selectedTagIds: []\n};\nexport const useCardManager = ({\n  isOpen = false,\n  mode,\n  closeModal,\n  item\n}) => {\n  _s();\n  const dispatch = useDispatch();\n  const tags = useSelector(selectAllTags);\n  const isEditMode = mode === \"edit\";\n  const initialFormValue = isEditMode && item ? item : initCardForm;\n  const {\n    form,\n    handleChange,\n    resetForm\n  } = useItemForm(initialFormValue);\n  const onSubmit = () => {\n    saveCard(dispatch, form, mode, item);\n    resetForm();\n    closeModal();\n  };\n  const handleToggleTag = id => {\n    handleChange(\"selectedTagIds\", form.selectedTagIds.includes(id) ? form.selectedTagIds.filter(tagId => tagId !== id) : [...form.selectedTagIds, id]);\n  };\n  useEffect(() => {\n    if (!isOpen) resetForm();\n  }, [isOpen]);\n  useEffect(() => {\n    if (item) {\n      handleChange('term', item.term);\n      handleChange('example_sentence', item.example_sentence);\n      handleChange('meaning', item.meaning);\n      handleChange('selectedTagIds', item.selectedTagIds);\n    }\n  }, [item]);\n  return {\n    isEditMode,\n    onSubmit,\n    handleChange,\n    form,\n    tags,\n    handleToggleTag\n  };\n};\n_s(useCardManager, \"PGOGIAbMxMtRkFrqRFww/J0w1xw=\", false, function () {\n  return [useDispatch, useSelector, useItemForm];\n});","map":{"version":3,"names":["useEffect","useDispatch","useSelector","saveCard","selectAllTags","useItemForm","initCardForm","term","meaning","example_sentence","selectedTagIds","useCardManager","isOpen","mode","closeModal","item","_s","dispatch","tags","isEditMode","initialFormValue","form","handleChange","resetForm","onSubmit","handleToggleTag","id","includes","filter","tagId"],"sources":["D:/base/GitHub/MemoryCard/frontend/src/features/cardManager/model/useCardManager.ts"],"sourcesContent":["import React, {useEffect} from 'react';\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {saveCard} from \"./services\";\r\nimport {Card} from \"../../../entities/card\";\r\nimport {selectAllTags} from \"../../../entities/tag\";\r\nimport {useItemForm} from \"../../../shared/hooks\";\r\nimport { BaseManagerProps } from '../../../shared/types';\r\n\r\nexport type CardForm = Partial<Pick<Card, 'id' | 'term' | 'meaning' | 'level' | 'example_sentence'>> & {\r\n    selectedTagIds: number[];\r\n}\r\n\r\nexport interface CardManagerProps extends BaseManagerProps<CardForm> {\r\n    item?: any;\r\n}\r\n\r\nconst initCardForm = {\r\n    term: '',\r\n    meaning: '',\r\n    example_sentence: '',\r\n    selectedTagIds: []\r\n}\r\n\r\nexport const useCardManager = ({isOpen = false, mode, closeModal, item}: BaseManagerProps<CardForm>) => {\r\n    const dispatch = useDispatch();\r\n    const tags = useSelector(selectAllTags);\r\n    const isEditMode = mode === \"edit\";\r\n\r\n    const initialFormValue = isEditMode && item ? item : initCardForm;\r\n    const {form, handleChange, resetForm} = useItemForm<CardForm>(initialFormValue);\r\n\r\n\r\n    const onSubmit = () => {\r\n        saveCard(dispatch, form, mode, item);\r\n        resetForm();\r\n        closeModal();\r\n    };\r\n\r\n    const handleToggleTag = (id: number) => {\r\n        handleChange(\r\n            \"selectedTagIds\",\r\n            form.selectedTagIds.includes(id)\r\n                ? form.selectedTagIds.filter(tagId => tagId !== id)\r\n                : [...form.selectedTagIds, id]\r\n        );\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (!isOpen) resetForm();\r\n    }, [isOpen]);\r\n\r\n    useEffect(() => {\r\n        if (item) {\r\n            handleChange('term', item.term);\r\n            handleChange('example_sentence', item.example_sentence);\r\n            handleChange('meaning', item.meaning);\r\n            handleChange('selectedTagIds', item.selectedTagIds);\r\n        }\r\n\r\n    }, [item]);\r\n\r\n    return {\r\n        isEditMode,\r\n        onSubmit,\r\n        handleChange,\r\n        form,\r\n        tags,\r\n        handleToggleTag,\r\n    };\r\n};"],"mappings":";AAAA,SAAeA,SAAS,QAAO,OAAO;AACtC,SAAQC,WAAW,EAAEC,WAAW,QAAO,aAAa;AACpD,SAAQC,QAAQ,QAAO,YAAY;AAEnC,SAAQC,aAAa,QAAO,uBAAuB;AACnD,SAAQC,WAAW,QAAO,uBAAuB;AAWjD,MAAMC,YAAY,GAAG;EACjBC,IAAI,EAAE,EAAE;EACRC,OAAO,EAAE,EAAE;EACXC,gBAAgB,EAAE,EAAE;EACpBC,cAAc,EAAE;AACpB,CAAC;AAED,OAAO,MAAMC,cAAc,GAAGA,CAAC;EAACC,MAAM,GAAG,KAAK;EAAEC,IAAI;EAAEC,UAAU;EAAEC;AAAgC,CAAC,KAAK;EAAAC,EAAA;EACpG,MAAMC,QAAQ,GAAGhB,WAAW,CAAC,CAAC;EAC9B,MAAMiB,IAAI,GAAGhB,WAAW,CAACE,aAAa,CAAC;EACvC,MAAMe,UAAU,GAAGN,IAAI,KAAK,MAAM;EAElC,MAAMO,gBAAgB,GAAGD,UAAU,IAAIJ,IAAI,GAAGA,IAAI,GAAGT,YAAY;EACjE,MAAM;IAACe,IAAI;IAAEC,YAAY;IAAEC;EAAS,CAAC,GAAGlB,WAAW,CAAWe,gBAAgB,CAAC;EAG/E,MAAMI,QAAQ,GAAGA,CAAA,KAAM;IACnBrB,QAAQ,CAACc,QAAQ,EAAEI,IAAI,EAAER,IAAI,EAAEE,IAAI,CAAC;IACpCQ,SAAS,CAAC,CAAC;IACXT,UAAU,CAAC,CAAC;EAChB,CAAC;EAED,MAAMW,eAAe,GAAIC,EAAU,IAAK;IACpCJ,YAAY,CACR,gBAAgB,EAChBD,IAAI,CAACX,cAAc,CAACiB,QAAQ,CAACD,EAAE,CAAC,GAC1BL,IAAI,CAACX,cAAc,CAACkB,MAAM,CAACC,KAAK,IAAIA,KAAK,KAAKH,EAAE,CAAC,GACjD,CAAC,GAAGL,IAAI,CAACX,cAAc,EAAEgB,EAAE,CACrC,CAAC;EACL,CAAC;EAED1B,SAAS,CAAC,MAAM;IACZ,IAAI,CAACY,MAAM,EAAEW,SAAS,CAAC,CAAC;EAC5B,CAAC,EAAE,CAACX,MAAM,CAAC,CAAC;EAEZZ,SAAS,CAAC,MAAM;IACZ,IAAIe,IAAI,EAAE;MACNO,YAAY,CAAC,MAAM,EAAEP,IAAI,CAACR,IAAI,CAAC;MAC/Be,YAAY,CAAC,kBAAkB,EAAEP,IAAI,CAACN,gBAAgB,CAAC;MACvDa,YAAY,CAAC,SAAS,EAAEP,IAAI,CAACP,OAAO,CAAC;MACrCc,YAAY,CAAC,gBAAgB,EAAEP,IAAI,CAACL,cAAc,CAAC;IACvD;EAEJ,CAAC,EAAE,CAACK,IAAI,CAAC,CAAC;EAEV,OAAO;IACHI,UAAU;IACVK,QAAQ;IACRF,YAAY;IACZD,IAAI;IACJH,IAAI;IACJO;EACJ,CAAC;AACL,CAAC;AAACT,EAAA,CA9CWL,cAAc;EAAA,QACNV,WAAW,EACfC,WAAW,EAIgBG,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}