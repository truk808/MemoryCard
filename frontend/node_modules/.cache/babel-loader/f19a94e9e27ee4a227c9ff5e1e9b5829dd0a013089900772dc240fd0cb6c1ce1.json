{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useMemo, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectAllCardTags } from \"../../../entities/cardTag\";\nimport { selectAllCards } from \"../../../entities/card\";\nimport { selectAllTags } from \"../../../entities/tag\";\nimport { selectAllModuleCards } from \"../../../entities/moduleCard\";\nexport function useDictionaryLogic() {\n  _s();\n  // переделать (перегруженный компонент)\n  const cards = useSelector(selectAllCards);\n  const tags = useSelector(selectAllTags);\n  const cardTags = useSelector(selectAllCardTags);\n  const cardModules = useSelector(selectAllModuleCards);\n  const [onlyWithoutTags, setOnlyWithoutTags] = useState(false);\n  const [onlyWithoutModules, setOnlyWithoutModules] = useState(false);\n  const [isOpenCardManager, setIsOpenCardManager] = useState(false);\n  const [isOpenTagManager, setIsOpenTagManager] = useState(false);\n  const [selectedTagIds, setSelectedTagIds] = useState([]);\n  const [editCard, setEditCard] = useState(undefined);\n  const [searchValue, setSearchValue] = useState('');\n  const tagItems = tags.map(tag => ({\n    id: tag.id,\n    label: tag.name\n  }), []);\n  const cardsWithTags = useMemo(() => {\n    return cards.map(card => {\n      const relatedTagIds = cardTags.filter(ct => ct.cardId === card.id).map(ct => ct.tagId);\n      const cardTagsList = tags.filter(tag => relatedTagIds.includes(tag.id));\n      return {\n        ...card,\n        tags: cardTagsList\n      };\n    });\n  }, [cards, tags, cardTags]);\n  const filteredCards = useMemo(() => {\n    const normalized = searchValue.trim().toLowerCase();\n    return cardsWithTags.filter(card => {\n      const matchesTerm = !normalized || card.term.toLowerCase().includes(normalized);\n      const matchesTags = selectedTagIds.length === 0 || selectedTagIds.every(tagId => card.tags.some(tag => tag.id === tagId));\n      const matchesWithoutTags = !onlyWithoutTags || card.tags.length === 0;\n      const matchesWithoutModules = !onlyWithoutModules || !cardModules.some(cm => cm.cardId === card.id);\n      return matchesTerm && matchesTags && matchesWithoutTags && matchesWithoutModules;\n    });\n  }, [cardsWithTags, cardModules, searchValue, selectedTagIds, onlyWithoutTags, onlyWithoutModules]);\n  const editCardInfo = useMemo(() => {\n    if (!editCard) return undefined;\n    return {\n      id: editCard.id,\n      term: editCard.term,\n      meaning: editCard.meaning,\n      example_sentence: editCard.example_sentence,\n      selectedTagIds: editCard.tags.map(tag => tag.id)\n    };\n  }, [editCard]);\n  return {\n    cardsWithTags,\n    filteredCards,\n    editCardInfo,\n    isOpenCardManager,\n    isOpenTagManager,\n    editCard,\n    searchValue,\n    setSearchValue,\n    setEditCard,\n    setIsOpenCardManager,\n    setIsOpenTagManager,\n    tagItems,\n    selectedTagIds,\n    setSelectedTagIds,\n    onlyWithoutModules,\n    setOnlyWithoutModules,\n    onlyWithoutTags,\n    setOnlyWithoutTags\n  };\n}\n_s(useDictionaryLogic, \"sgpvzbQCvs7Os8lUvY2Z8SJL5Ls=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector];\n});","map":{"version":3,"names":["useMemo","useState","useSelector","selectAllCardTags","selectAllCards","selectAllTags","selectAllModuleCards","useDictionaryLogic","_s","cards","tags","cardTags","cardModules","onlyWithoutTags","setOnlyWithoutTags","onlyWithoutModules","setOnlyWithoutModules","isOpenCardManager","setIsOpenCardManager","isOpenTagManager","setIsOpenTagManager","selectedTagIds","setSelectedTagIds","editCard","setEditCard","undefined","searchValue","setSearchValue","tagItems","map","tag","id","label","name","cardsWithTags","card","relatedTagIds","filter","ct","cardId","tagId","cardTagsList","includes","filteredCards","normalized","trim","toLowerCase","matchesTerm","term","matchesTags","length","every","some","matchesWithoutTags","matchesWithoutModules","cm","editCardInfo","meaning","example_sentence"],"sources":["D:/base/GitHub/MemoryCard/frontend/src/widgets/dictionarySection/model/useDictionaryLogic.ts"],"sourcesContent":["import {useEffect, useMemo, useState} from \"react\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {selectAllCardTags} from \"../../../entities/cardTag\";\r\nimport {selectAllCards} from \"../../../entities/card\";\r\nimport {selectAllTags} from \"../../../entities/tag\";\r\nimport {selectAllModuleCards} from \"../../../entities/moduleCard\";\r\n\r\nimport {CardWithTags} from \"../../../shared/types/entityTypes\";\r\n\r\nexport function useDictionaryLogic() {\r\n    // переделать (перегруженный компонент)\r\n    const cards = useSelector(selectAllCards);\r\n    const tags = useSelector(selectAllTags);\r\n    const cardTags = useSelector(selectAllCardTags);\r\n    const cardModules = useSelector(selectAllModuleCards);\r\n\r\n    const [onlyWithoutTags, setOnlyWithoutTags] = useState(false);\r\n    const [onlyWithoutModules, setOnlyWithoutModules] = useState(false);\r\n    const [isOpenCardManager, setIsOpenCardManager] = useState(false);\r\n    const [isOpenTagManager, setIsOpenTagManager] = useState(false);\r\n    const [selectedTagIds, setSelectedTagIds] = useState<number[]>([]);\r\n    const [editCard, setEditCard] = useState<CardWithTags | undefined>(undefined);\r\n\r\n    const [searchValue, setSearchValue] = useState('');\r\n\r\n    const tagItems = tags.map(tag => ({\r\n        id: tag.id,\r\n        label: tag.name,\r\n    }), []);\r\n    \r\n    const cardsWithTags: CardWithTags[] = useMemo(() => {\r\n        return cards.map((card) => {\r\n            const relatedTagIds = cardTags\r\n                .filter(ct => ct.cardId === card.id)\r\n                .map(ct => ct.tagId);\r\n            const cardTagsList = tags.filter(tag => relatedTagIds.includes(tag.id));\r\n            return {...card, tags: cardTagsList};\r\n        });\r\n    }, [cards, tags, cardTags]);\r\n\r\n    const filteredCards = useMemo(() => {\r\n        const normalized = searchValue.trim().toLowerCase();\r\n\r\n        return cardsWithTags.filter(card => {\r\n            const matchesTerm =\r\n                !normalized || card.term.toLowerCase().includes(normalized);\r\n\r\n            const matchesTags =\r\n                selectedTagIds.length === 0 ||\r\n                selectedTagIds.every(tagId =>\r\n                    card.tags.some(tag => tag.id === tagId)\r\n                );\r\n\r\n            const matchesWithoutTags =\r\n                !onlyWithoutTags || card.tags.length === 0;\r\n\r\n            const matchesWithoutModules =\r\n                !onlyWithoutModules ||\r\n                !cardModules.some(cm => cm.cardId === card.id);\r\n\r\n            return (\r\n                matchesTerm &&\r\n                matchesTags &&\r\n                matchesWithoutTags &&\r\n                matchesWithoutModules\r\n            );\r\n        });\r\n    }, [\r\n        cardsWithTags,\r\n        cardModules,\r\n        searchValue,\r\n        selectedTagIds,\r\n        onlyWithoutTags,\r\n        onlyWithoutModules,\r\n    ]);\r\n\r\n\r\n\r\n    const editCardInfo = useMemo(() => {\r\n        if (!editCard) return undefined;\r\n        return {\r\n            id: editCard.id,\r\n            term: editCard.term,\r\n            meaning: editCard.meaning,\r\n            example_sentence: editCard.example_sentence,\r\n            selectedTagIds: editCard.tags.map(tag => tag.id),\r\n        };\r\n    }, [editCard]);\r\n\r\n    return {\r\n        cardsWithTags,\r\n        filteredCards,\r\n        editCardInfo,\r\n        isOpenCardManager,\r\n        isOpenTagManager,\r\n        editCard,\r\n        searchValue,\r\n        setSearchValue,\r\n        setEditCard,\r\n        setIsOpenCardManager,\r\n        setIsOpenTagManager,\r\n\r\n        tagItems,\r\n        selectedTagIds,\r\n        setSelectedTagIds,\r\n\r\n        onlyWithoutModules,\r\n        setOnlyWithoutModules,\r\n        onlyWithoutTags,\r\n        setOnlyWithoutTags,\r\n    };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}